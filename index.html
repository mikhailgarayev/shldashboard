<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard from Google Sheets</title>
</head>
<body>
  <h1>Dashboard</h1>
  <div id="app">Загрузка...</div>

  <!-- Подключаем PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

  <script>
    // Ссылка на CSV (замените на свою!)
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSmaCLCDgsSsk-HY4qtkZteI60f1NxMCO4IYrFjeXoCbQRjAh0IeK0tJ4fMSScZqbS1troISgXNvssJ/pub?output=csv";

    // Функция для парсинга CSV через Papa Parse
    function fetchData() {
      Papa.parse(CSV_URL, {
        download: true,
        header: false, // или true, если в таблице есть заголовки
        complete: function(results) {
          // results.data – это двумерный массив со всеми данными таблицы
          const data = results.data;
          console.log("Все данные:", data);

          // Пример: извлекаем нужную информацию
          // Допустим, в столбцах D и E (в таблице это индексы 3 и 4)
          // находятся данные по платформе CS.
          // Или в конкретных ячейках (например, E4) что-то важное. 
          // Обратите внимание, что индексация массива идет с 0.
          
          // Например, вы упомянули, что ячейка E4 содержит число "12 активных сотрудников".
          // В логике массива Papa Parse это будет:
          // data[3][4] (3-я строка, 4-й столбец) — смотрите, какая в реальности получается у вас нумерация.
          const activeCSCell = data[3][4]; 
          console.log("Активных сотрудников (E4):", activeCSCell);

          // Пример: можете отобразить все имена, которые находятся ниже по строкам
          // Предположим, начиная со строки 4 по строку 15 (т.е. индексы в массиве 3..14).
          const activeCSNames = [];
          for (let i = 3; i <= 14; i++) {
            // столбец D (3) содержит имена? или E (4)?
            // Нужно проверить, в каком столбце фактически лежат имена.
            const name = data[i][3];
            if (name) {
              activeCSNames.push(name);
            }
          }

          // Аналогично можете доставать данные про Away-сотрудников, про Post order и т. д.

          // Рендерим всё это в элементе #app
          renderDashboard(activeCSCell, activeCSNames);
        }
      });
    }

    function renderDashboard(activeCount, activeNames) {
      const app = document.getElementById("app");
      
      let html = `
        <h2>Платформа CS</h2>
        <p>Активных сотрудников: ${activeCount}</p>
        <ul>
      `;
      activeNames.forEach(name => {
        html += `<li>${name}</li>`;
      });
      html += `</ul>`;

      app.innerHTML = html;
    }

    // Запускаем парсинг при загрузке страницы
    fetchData();
  </script>
</body>
</html>
