<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>SUMO Dashboard</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <style>
    /* –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
    body.hidden {
      display: none;
    }

    :root {
      --bg-color: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
      --text-color: #343a40;
      --card-bg-color: #ffffff;
      --card-text-color: #495057;
      --card-border-color: #dee2e6;
      --card-shadow: 0 4px 16px rgba(0,0,0,0.08);
      --card-hover-shadow: 0 6px 20px rgba(0,0,0,0.12);
      --menu-bg-color: #ffffff;
      --menu-shadow: 2px 0 5px rgba(0,0,0,0.2);
      --menu-width: 250px;
      --transition-speed: 0.3s;
    }
    body.dark-theme {
      --bg-color: linear-gradient(120deg, #2a2a2a 0%, #3c3c3c 100%);
      --text-color: #f0f0f0;
      --card-bg-color: #3a3a3a;
      --card-text-color: #e5e5e5;
      --card-border-color: #555555;
      --card-shadow: 0 4px 16px rgba(255,255,255,0.08);
      --card-hover-shadow: 0 6px 20px rgba(255,255,255,0.12);
      --menu-bg-color: #3a3a3a;
    }
    
    /* –û–±—â–∏–π —Å–±—Ä–æ—Å –∏ —Ñ–æ–Ω */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100vh;
      background: var(--bg-color);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow-x: hidden;
      color: var(--text-color);
      transition: background var(--transition-speed) ease, color var(--transition-speed) ease;
    }
    
    /* –°–∞–π–¥–±–∞—Ä (–º–µ–Ω—é) */
    .hamburger-menu {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1100;
      cursor: pointer;
    }
    .hamburger-menu span {
      font-size: 28px;
      color: var(--text-color);
    }
    #sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: var(--menu-width);
      height: 100%;
      background: var(--menu-bg-color);
      box-shadow: var(--menu-shadow);
      transition: left var(--transition-speed) ease;
      z-index: 1099;
      padding-top: 20px;
      padding-left: 15px;
      padding-right: 15px;
    }
    #sidebar.active {
      left: 0;
    }
    #sidebar .close-btn {
      display: block;
      text-align: right;
      font-size: 24px;
      cursor: pointer;
      margin-bottom: 10px;
      color: var(--text-color);
    }
    #sidebar a {
      display: block;
      padding: 10px 5px;
      color: var(--text-color);
      text-decoration: none;
      border-bottom: 1px solid var(--card-border-color);
    }
    #sidebar a:hover {
      background-color: var(--bg-color);
    }
    
    .dashboard-container {
      width: 100%;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      font-weight: 500;
      font-size: 2rem;
      color: var(--text-color);
    }
    
    /* –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ */
    .filter-panel {
      background: var(--card-bg-color);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
      box-shadow: var(--card-shadow);
    }
    .stats-card {
      padding: 10px 15px;
      background: var(--bg-color);
      border-radius: 8px;
      border: 1px solid var(--card-border-color);
      min-width: 180px;
    }
    .stats-title {
      font-size: 0.9rem;
      opacity: 0.7;
    }
    .stats-value {
      font-weight: bold;
      font-size: 1.2rem;
    }
    .filter-section {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .filter-dropdown {
      padding: 8px 12px;
      border: 1px solid var(--card-border-color);
      border-radius: 6px;
      background: var(--card-bg-color);
      min-width: 120px;
      color: var(--text-color);
    }
    .search-section {
      display: flex;
      margin-left: auto;
    }
    .search-input {
      padding: 8px 12px;
      border: 1px solid var(--card-border-color);
      border-radius: 6px 0 0 6px;
      background: var(--card-bg-color);
      width: 200px;
      color: var(--text-color);
    }
    .search-btn {
      padding: 8px 15px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 0 6px 6px 0;
      cursor: pointer;
    }
    .search-btn:hover {
      background: #0069d9;
    }
    
    /* –°–µ–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
    .refresh-section {
      margin-left: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .refresh-btn {
      padding: 6px 10px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .refresh-btn:hover {
      background-color: #218838;
    }
    .spinner-border {
      width: 1rem;
      height: 1rem;
      border-width: .1em;
    }
    
    /* Dropdown —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ */
    .dropdown-menu {
      max-height: 200px;
      overflow-y: auto;
    }
    .platform-checkbox {
      padding: 5px 15px;
    }
    
    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
    .theme-toggle-container {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "‚òÄ";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
      font-size: 12px;
      line-height: 18px;
      text-align: center;
      color: #f39c12;
    }
    input:checked + .slider {
      background-color: #007bff;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
      content: "üåô";
      color: #f1c40f;
    }
    
    /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã */
    .platforms-row {
      display: flex;
      flex-wrap: nowrap;
      align-items: flex-start;
      justify-content: space-between;
      overflow-x: auto;
      gap: 10px;
    }
    .platform-card {
      flex: 1 1 220px;
      min-width: 220px;
      background: var(--card-bg-color);
      color: var(--card-text-color);
      border-radius: 16px;
      padding: 20px;
      box-shadow: var(--card-shadow);
      transition: transform 0.2s, box-shadow 0.2s;
      overflow-wrap: break-word;
    }
    .platform-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--card-hover-shadow);
    }
    .platform-card h5 {
      text-align: center;
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 12px;
      color: var(--text-color);
    }
    .platform-card h5 .info-icon {
      display: inline-block;
      margin-left: 5px;
      cursor: pointer;
      font-size: 0.9rem;
      vertical-align: middle;
    }
    .platform-card p {
      text-align: center;
      margin: 10px 0;
      font-size: 0.85rem;
      color: #6c757d;
    }
    .platform-card ul {
      list-style: none;
      padding-left: 0;
      font-size: 0.85rem;
      color: var(--card-text-color);
    }
    .platform-card ul li {
      padding: 4px 0;
      cursor: pointer;
      border-bottom: 1px solid var(--card-border-color);
    }
    .platform-card ul li:last-child {
      border-bottom: none;
    }
    .shift-summary-card {
      background: none !important;
      color: var(--card-text-color);
      border: none !important;
      box-shadow: none !important;
      padding: 20px;
      margin: 0 auto 40px;
      text-align: center;
      overflow-wrap: break-word;
      color: #f8f9fa;
      font-size: 1.2rem;
      font-weight: 700;
    }
    .shift-summary-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--card-hover-shadow);
    }
    .shift-summary-title {
      margin-bottom: 16px;
      font-weight: 600;
      font-size: 1.3rem;
      color: var(--text-color);
    }
    .shift-summary-grid {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      table-layout: auto;
      font-size: 2rem;
    }
    .shift-summary-grid th,
    .shift-summary-grid td {
      padding: 8px 12px;
      text-align: center;
      font-size: 0.85rem;
      color: var(--card-text-color);
    }
    .shift-summary-grid th {
      background: none !important;
      font-weight: 600;
    }
    .shift-summary-grid td {
      background: none !important;
      border: 1px solid var(--card-border-color);
      border-radius: 8px;
    }
    .small-font-card {
      font-size: 0.9rem;
    }
    .shift-card-title {
      font-size: 1.4rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      text-align: center;
    }
    .shift-card-away {
      font-size: 1.1rem;
      color: #666;
      text-align: center;
    }
    #breaks-section {
      margin-top: 40px;
    }
    #breaks-section h2 {
      text-align: center;
      margin-bottom: 20px;
      font-weight: 500;
      font-size: 1.5rem;
      color: var(--text-color);
    }
    .break-card {
      background: var(--card-bg-color);
      color: var(--card-text-color);
      border-radius: 16px;
      box-shadow: var(--card-shadow);
      padding: 20px;
      margin: 0 auto 40px;
      max-width: 600px;
      text-align: center;
      overflow-wrap: break-word;
    }
    .break-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--card-hover-shadow);
    }
    .break-card h5 {
      margin-bottom: 12px;
      font-weight: 600;
      font-size: 1.1rem;
      color: var(--text-color);
    }
    .break-card ul {
      list-style: none;
      padding-left: 0;
      font-size: 0.85rem;
      color: var(--card-text-color);
    }
    .break-card ul li {
      padding: 6px 0;
      border-bottom: 1px solid var(--card-border-color);
    }
    .break-card ul li:last-child {
      border-bottom: none;
    }
    
    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ */
    #modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
    }
    #employee-modal {
      display: none;
      position: fixed;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--card-bg-color);
      color: var(--card-text-color);
      border: 1px solid var(--card-border-color);
      box-shadow: var(--card-shadow);
      border-radius: 8px;
      padding: 20px;
      z-index: 1001;
      width: 330px;
    }
    #employee-modal h3 {
      margin: 0 0 8px 0;
    }
    #employee-modal .close-btn {
      position: absolute;
      top: 8px;
      right: 12px;
      cursor: pointer;
      font-size: 20px;
    }
    #employee-modal a {
      color: #007bff;
      text-decoration: underline;
    }
    #employee-modal a:hover {
      color: #0056b3;
    }
  </style>

</head>
<body class="hidden"> <!-- –ü—Ä—è—á–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
  <!-- –ì–∞–º–±—É—Ä–≥–µ—Ä-–º–µ–Ω—é -->
  <div class="hamburger-menu" id="hamburger-menu">
    <span>&#9776;</span>
  </div>
  <!-- –°–∞–π–¥–±–∞—Ä —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
  <div id="sidebar">
    <div class="close-btn" id="sidebar-close">&times;</div>
    <a href="https://example.com" target="_blank">YIGIM Dashboard</a>
    <a href="https://anotherexample.com" target="_blank">Datadog Dashboard</a>
    <a href="https://yetanother.com" target="_blank">City States</a>
    <a href="https://yetanother.com" target="_blank">City Tools</a>
    <a href="https://yetanother.com" target="_blank">Converse Admin Panel</a>
  </div>

  <div class="dashboard-container">
    <h1>Support Monitoring Dashboard</h1>
    
    <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏ -->
    <div class="filter-panel">
      <div class="stats-card">
        <span class="stats-title">Baku Central</span>
        <span class="stats-value">1.1</span>
      </div>
      
      <!-- WEATHER CARD -->
      <div class="stats-card" id="weather-card">
        <span class="stats-title">Baku Weather</span>
        <span class="stats-value" id="baku-temp">-- ¬∞C</span>
        <br/>
        <span class="stats-title">Wind Speed</span>
        <span class="stats-value" id="baku-wind">-- m/s</span>
      </div>
      
      <div class="filter-section">
        <!-- Status Filter -->
        <select id="status-filter" class="filter-dropdown">
          <option value="both">Status</option>
          <option value="active">Active</option>
          <option value="away">Away</option>
        </select>
        <!-- Dropdown –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º -->
        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="platformDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Platform
          </button>
          <div class="dropdown-menu" aria-labelledby="platformDropdown" id="platform-dropdown-menu">
            <div class="dropdown-item platform-checkbox">
              <div class="form-check">
                <input class="form-check-input platform-option" type="checkbox" value="all" id="platform-all" checked>
                <label class="form-check-label" for="platform-all">–í—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</label>
              </div>
            </div>
            <!-- –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è -->
          </div>
        </div>
        <!-- Reallocate Filter -->
        <select id="realloc-filter" class="filter-dropdown">
          <option value="all">Reallocate: All</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <!-- Language Filter -->
        <select id="lang-filter" class="filter-dropdown">
          <option value="all">Language: All</option>
          <option value="two">Bilingual</option>
          <option value="three">Trilingual</option>
        </select>
        <!-- Break Filter -->
        <select id="break-filter" class="filter-dropdown">
          <option value="upcoming">Breaks: Upcoming</option>
          <option value="all">Breaks: All</option>
        </select>
      </div>
      
      <div class="search-section">
        <input type="text" id="employee-search" placeholder="Search..." class="search-input">
        <button class="search-btn">Search</button>
      </div>
      
      <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
      <div class="theme-toggle-container">
        <span>–¢–µ–º–∞:</span>
        <label class="theme-switch">
          <input type="checkbox" id="theme-checkbox">
          <span class="slider"></span>
        </label>
      </div>
      
      <!-- –°–µ–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —Ç–∞–π–º–µ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π refresh now -->
      <div class="refresh-section">
        <span id="timer-label">Refresh in: <span id="countdown">15</span> s</span>
        <div id="refresh-spinner" class="spinner-border text-primary" role="status" style="display:none;">
          <span class="sr-only">Loading...</span>
        </div>
        <button class="refresh-btn" onclick="refreshNow()">Refresh now</button>
      </div>
      
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="shift-summary" class="shift-summary-card">
      <div class="shift-summary-title">Statistics per platform</div>
      <table class="shift-summary-grid" id="summary-table"></table>
    </div>
    
    <div id="platforms-container" class="platforms-row"></div>
    
    <div id="breaks-section">
      <h2>Upcoming Breaks</h2>
      <div id="breaks-app"></div>
    </div>
  </div>
  
  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
  <div id="modal-overlay"></div>
  <div id="employee-modal">
    <span class="close-btn" id="modal-close">&times;</span>
    <h3 id="modal-emp-name"></h3>
    <p><strong>Can Reallocate?</strong>: <span id="modal-emp-realloc"></span></p>
    <p><strong>Prime Platform:</strong> <span id="modal-emp-prime"></span></p>
    <p><strong>Preferred Platform:</strong> <span id="modal-emp-pref"></span></p>
    <p><strong>Languages:</strong> <span id="modal-emp-languages"></span></p>
    <p>
      <a id="modal-inbox-link" href="#" target="_blank">Inbox</a> |
      <a id="modal-admin-link" href="#" target="_blank">Admin Dashboard</a>
    </p>
  </div>
  
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø FIREBASE / –ü–†–û–í–ï–†–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
    // (–°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö email –∏ onAuthStateChanged)
    // -- –£–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –≤ <head>, –ø—Ä–æ–¥–æ–ª–∂–∏–º:
    
    // –ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    auth.onAuthStateChanged((user) => {
      if (!user) {
        // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω => —É—Ö–æ–¥–∏–º –Ω–∞ login
        window.location.replace("login.html");
      } else {
        const allowedEmails = [
          "mikhail.garayev@wolt.com",
          "user2@example.com"
        ];
        if (!allowedEmails.includes(user.email)) {
          // –í—ã—Ö–æ–¥–∏–º –∏ —É—Ö–æ–¥–∏–º, –µ—Å–ª–∏ email –Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω
          auth.signOut().then(() => {
            window.location.replace("login.html");
          });
        } else {
          // –ï—Å–ª–∏ –≤—Å—ë –æ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
          document.body.classList.remove("hidden");
        }
      }
    });

    /* –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (fetchData, fetchWeather, initPlatformCheckboxes, –∏ —Ç.–¥.) */
    // ==========================================================
    
    const OPENWEATHER_API_KEY = "f97220cfb6bcefa391405990e7b9825d";
    const CITY_NAME = "Baku,AZ";

    /* ... —Ç–æ—Ç –∂–µ –∫–æ–¥ fetchWeather(), updateWeatherUI(), etc. */
    // –°–º. –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –≤—Å—ë –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    // ...
    
    // –ü—Ä–∏–º–µ—Ä: –ø–æ—Å–ª–µ DOMContentLoaded –∑–∞–ø—É—Å–∫–∞–µ–º initPlatformCheckboxes, fetchData, fetchWeather
    document.addEventListener("DOMContentLoaded", () => {
      // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ body.hidden => –∂–¥—ë–º onAuthStateChanged
      
      // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã) –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å, 
      // –Ω–æ –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ auth.
      initPlatformCheckboxes();
      loadThemePreference();
      
      // –ù–∞–≤–µ—à–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      // ...
      
      // –ó–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏
      fetchData();
      fetchWeather();
    });
  </script>
</body>
</html>
